{% extends "admin/index.html" %}
{% load static %}

{% block content %}
<div id="family-dashboard">
    <!-- Welcome Section -->
    <div class="dashboard-welcome">
        <h2>æ¬¢è¿å›åˆ°å®¶æ—çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ</h2>
        <p class="welcome-message">è®°å½•æ¯ä¸€ä¸ªçè´µæ—¶åˆ»ï¼Œä¼ æ‰¿å®¶æ—çš„æ¸©æš–å›å¿†</p>
    </div>

    <!-- Quick Actions Panel -->
    <div class="dashboard-section">
        <h3>å¿«é€Ÿæ“ä½œ</h3>
        <div class="quick-actions">
            <a href="{% url 'admin:family_person_add' %}" class="quick-action-card family-card">
                <div class="action-icon">ğŸ‘¥</div>
                <div class="action-title">æ·»åŠ å®¶åº­æˆå‘˜</div>
                <div class="action-desc">è®°å½•æ–°çš„å®¶åº­æˆå‘˜ä¿¡æ¯</div>
            </a>
            <a href="{% url 'admin:family_story_add' %}" class="quick-action-card story-card">
                <div class="action-icon">ğŸ“–</div>
                <div class="action-title">è®°å½•å®¶æ—æ•…äº‹</div>
                <div class="action-desc">åˆ†äº«çè´µçš„å®¶æ—å›å¿†</div>
            </a>
            <a href="{% url 'admin:family_event_add' %}" class="quick-action-card event-card">
                <div class="action-icon">ğŸ‰</div>
                <div class="action-title">åˆ›å»ºé‡è¦äº‹ä»¶</div>
                <div class="action-desc">è®°å½•ç‰¹æ®Šçš„æ—¥å­å’Œåº†ç¥</div>
            </a>
            <a href="{% url 'admin:family_multimedia_add' %}" class="quick-action-card media-card">
                <div class="action-icon">ğŸ“¸</div>
                <div class="action-title">ä¸Šä¼ ç…§ç‰‡è§†é¢‘</div>
                <div class="action-desc">ä¿å­˜çè´µçš„å½±åƒè®°å¿†</div>
            </a>
        </div>
    </div>

    <!-- Family Statistics -->
    <div class="dashboard-section">
        <h3>å®¶æ—æ¦‚è§ˆ</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="family-count">{{ family_stats.person_count|default:"0" }}</div>
                <div class="stat-label">å®¶åº­æˆå‘˜</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="story-count">{{ family_stats.story_count|default:"0" }}</div>
                <div class="stat-label">å®¶æ—æ•…äº‹</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="event-count">{{ family_stats.event_count|default:"0" }}</div>
                <div class="stat-label">é‡è¦äº‹ä»¶</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="media-count">{{ family_stats.multimedia_count|default:"0" }}</div>
                <div class="stat-label">ç…§ç‰‡è§†é¢‘</div>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="dashboard-section">
        <h3>æœ€è¿‘æ´»åŠ¨</h3>
        <div class="recent-activity">
            {% if recent_activities %}
                {% for activity in recent_activities %}
                <div class="activity-item">
                    <div class="activity-icon">{{ activity.icon }}</div>
                    <div class="activity-content">
                        <div class="activity-title">{{ activity.title }}</div>
                        <div class="activity-time">{{ activity.time }}</div>
                    </div>
                    <a href="{{ activity.url }}" class="activity-link">æŸ¥çœ‹</a>
                </div>
                {% endfor %}
            {% else %}
                <div class="no-activity">
                    <p>è¿˜æ²¡æœ‰æ´»åŠ¨è®°å½•ï¼Œå¼€å§‹è®°å½•æ‚¨çš„å®¶æ—å›å¿†å§ï¼</p>
                    <a href="{% url 'admin:family_story_add' %}" class="start-recording-btn">å¼€å§‹è®°å½•</a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Upcoming Events -->
    <div class="dashboard-section">
        <h3>å³å°†åˆ°æ¥çš„äº‹ä»¶</h3>
        <div class="upcoming-events">
            {% if upcoming_events %}
                {% for event in upcoming_events %}
                <div class="event-item">
                    <div class="event-date">
                        <div class="event-day">{{ event.date.day }}</div>
                        <div class="event-month">{{ event.date.month }}æœˆ</div>
                    </div>
                    <div class="event-details">
                        <div class="event-title">{{ event.title }}</div>
                        <div class="event-time">{{ event.date|date:"Yå¹´mæœˆdæ—¥" }}</div>
                    </div>
                    <a href="{% url 'admin:family_event_change' event.id %}" class="event-link">è¯¦æƒ…</a>
                </div>
                {% endfor %}
            {% else %}
                <div class="no-events">
                    <p>æš‚æ— å³å°†åˆ°æ¥çš„äº‹ä»¶</p>
                    <a href="{% url 'admin:family_event_add' %}" class="add-event-btn">åˆ›å»ºäº‹ä»¶</a>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Original Django Admin Content -->
<div id="original-admin-content" style="margin-top: 2rem;">
    {{ block.super }}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load family statistics
    loadFamilyStats();
    
    // Add touch-friendly interactions for mobile
    if ('ontouchstart' in window) {
        document.body.classList.add('touch-device');
    }
});

function loadFamilyStats() {
    // This would typically load from an AJAX endpoint
    // For now, we'll use placeholder logic
    console.log('Family dashboard loaded');
}
</script>

{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
/* Dashboard specific styles will be in family_admin.css */
</style>
{% endblock %}